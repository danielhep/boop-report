"use client";

import React from "react";
import { useOrcaStore } from "@/lib/store/orcaStoreProvider";

const OrcaReader = () => {
	const totalTaps = useOrcaStore((state) => state.processedStats?.aggregateExtraData.totalTaps);
	// Validate number is between 1-4 digits
	const validNumber = Math.max(
		0,
		Math.min(9999, Math.floor(Number(totalTaps) || 0)),
	);

	// Calculate font size based on number of digits
	const getFontSize = () => {
		const digits = validNumber.toString().length;
		switch (digits) {
			case 1:
				return "60px";
			case 2:
				return "50px";
			case 3:
				return "40px";
			case 4:
				return "32px";
			default:
				return "32px";
		}
	};
	return (
		<svg
			width="254"
			height="371"
			viewBox="0 0 254 371"
			fill="none"
			xmlns="http://www.w3.org/2000/svg"
			role="img"
			aria-labelledby="orcaTitle orcaDesc"
		>
			<title id="orcaTitle">Orca Card Reader</title>
			<desc id="orcaDesc">An illustration of an Orca card reader displaying the number {validNumber}</desc>
			<g filter="url(#filter0_d_40_2390)">
				<rect
					x="4.41797"
					width="245.582"
					height="198.687"
					rx="70"
					fill="#DA9300"
				/>
				<path d="M95 298H159V371H95V298Z" fill="#DA9300" />
				<rect
					x="29.0995"
					y="23.4476"
					width="196.219"
					height="283.427"
					rx="58"
					fill="#FCB421"
				/>
				<rect
					x="37.3268"
					y="31.2634"
					width="179.765"
					height="266.973"
					rx="49"
					fill="#5A595E"
				/>
				<rect
					x="47.3715"
					y="71.9005"
					width="157.808"
					height="103.649"
					fill="black"
				/>
				<ellipse
					cx="127.415"
					cy="232.213"
					rx="31.6748"
					ry="33.5259"
					fill="#082535"
				/>
			</g>
			<text
				x="127"
				y="115"
				fill="#00CFEA"
				fontSize={getFontSize()}
				fontFamily="Open Sans"
				textAnchor="middle"
				dominantBaseline="middle"
				fontWeight="bold"
			>
				{validNumber}
			</text>
			<path
				d="M93.8906 158H92.0078V148.172H88.6641V146.578H97.2266V148.172H93.8906V158ZM106.445 153.656C106.445 154.375 106.352 155.013 106.164 155.57C105.977 156.128 105.703 156.599 105.344 156.984C104.984 157.365 104.552 157.656 104.047 157.859C103.542 158.057 102.971 158.156 102.336 158.156C101.742 158.156 101.198 158.057 100.703 157.859C100.208 157.656 99.7786 157.365 99.4141 156.984C99.0547 156.599 98.776 156.128 98.5781 155.57C98.3802 155.013 98.2812 154.375 98.2812 153.656C98.2812 152.703 98.4453 151.896 98.7734 151.234C99.1068 150.568 99.5807 150.06 100.195 149.711C100.81 149.362 101.542 149.188 102.391 149.188C103.188 149.188 103.891 149.362 104.5 149.711C105.109 150.06 105.586 150.568 105.93 151.234C106.273 151.901 106.445 152.708 106.445 153.656ZM100.172 153.656C100.172 154.286 100.247 154.826 100.398 155.273C100.555 155.721 100.794 156.065 101.117 156.305C101.44 156.539 101.857 156.656 102.367 156.656C102.878 156.656 103.294 156.539 103.617 156.305C103.94 156.065 104.177 155.721 104.328 155.273C104.479 154.826 104.555 154.286 104.555 153.656C104.555 153.026 104.479 152.492 104.328 152.055C104.177 151.612 103.94 151.276 103.617 151.047C103.294 150.812 102.875 150.695 102.359 150.695C101.599 150.695 101.044 150.951 100.695 151.461C100.346 151.971 100.172 152.703 100.172 153.656ZM111.773 156.672C112.013 156.672 112.25 156.651 112.484 156.609C112.719 156.562 112.932 156.508 113.125 156.445V157.836C112.922 157.924 112.659 158 112.336 158.062C112.013 158.125 111.677 158.156 111.328 158.156C110.839 158.156 110.398 158.076 110.008 157.914C109.617 157.747 109.307 157.464 109.078 157.062C108.849 156.661 108.734 156.107 108.734 155.398V150.75H107.555V149.93L108.82 149.281L109.422 147.43H110.578V149.352H113.055V150.75H110.578V155.375C110.578 155.812 110.688 156.138 110.906 156.352C111.125 156.565 111.414 156.672 111.773 156.672ZM118.273 149.188C119.367 149.188 120.193 149.43 120.75 149.914C121.312 150.398 121.594 151.154 121.594 152.18V158H120.289L119.938 156.773H119.875C119.63 157.086 119.378 157.344 119.117 157.547C118.857 157.75 118.555 157.901 118.211 158C117.872 158.104 117.458 158.156 116.969 158.156C116.453 158.156 115.992 158.062 115.586 157.875C115.18 157.682 114.859 157.391 114.625 157C114.391 156.609 114.273 156.115 114.273 155.516C114.273 154.625 114.604 153.956 115.266 153.508C115.932 153.06 116.938 152.812 118.281 152.766L119.781 152.711V152.258C119.781 151.659 119.641 151.232 119.359 150.977C119.083 150.721 118.693 150.594 118.188 150.594C117.755 150.594 117.336 150.656 116.93 150.781C116.523 150.906 116.128 151.06 115.742 151.242L115.148 149.945C115.57 149.721 116.049 149.539 116.586 149.398C117.128 149.258 117.69 149.188 118.273 149.188ZM119.773 153.867L118.656 153.906C117.74 153.938 117.096 154.094 116.727 154.375C116.357 154.656 116.172 155.042 116.172 155.531C116.172 155.958 116.299 156.271 116.555 156.469C116.81 156.661 117.146 156.758 117.562 156.758C118.198 156.758 118.724 156.578 119.141 156.219C119.562 155.854 119.773 155.32 119.773 154.617V153.867ZM126.008 158H124.164V145.844H126.008V158ZM136.938 158H135.055V148.172H131.711V146.578H140.273V148.172H136.938V158ZM145.227 149.188C146.32 149.188 147.146 149.43 147.703 149.914C148.266 150.398 148.547 151.154 148.547 152.18V158H147.242L146.891 156.773H146.828C146.583 157.086 146.331 157.344 146.07 157.547C145.81 157.75 145.508 157.901 145.164 158C144.826 158.104 144.411 158.156 143.922 158.156C143.406 158.156 142.945 158.062 142.539 157.875C142.133 157.682 141.812 157.391 141.578 157C141.344 156.609 141.227 156.115 141.227 155.516C141.227 154.625 141.557 153.956 142.219 153.508C142.885 153.06 143.891 152.812 145.234 152.766L146.734 152.711V152.258C146.734 151.659 146.594 151.232 146.312 150.977C146.036 150.721 145.646 150.594 145.141 150.594C144.708 150.594 144.289 150.656 143.883 150.781C143.477 150.906 143.081 151.06 142.695 151.242L142.102 149.945C142.523 149.721 143.003 149.539 143.539 149.398C144.081 149.258 144.643 149.188 145.227 149.188ZM146.727 153.867L145.609 153.906C144.693 153.938 144.049 154.094 143.68 154.375C143.31 154.656 143.125 155.042 143.125 155.531C143.125 155.958 143.253 156.271 143.508 156.469C143.763 156.661 144.099 156.758 144.516 156.758C145.151 156.758 145.677 156.578 146.094 156.219C146.516 155.854 146.727 155.32 146.727 154.617V153.867ZM155.555 149.188C156.581 149.188 157.404 149.562 158.023 150.312C158.648 151.062 158.961 152.177 158.961 153.656C158.961 154.635 158.815 155.461 158.523 156.133C158.237 156.799 157.833 157.305 157.312 157.648C156.797 157.987 156.195 158.156 155.508 158.156C155.07 158.156 154.69 158.099 154.367 157.984C154.044 157.87 153.768 157.721 153.539 157.539C153.31 157.352 153.117 157.148 152.961 156.93H152.852C152.878 157.138 152.901 157.37 152.922 157.625C152.948 157.875 152.961 158.104 152.961 158.312V161.836H151.117V149.352H152.617L152.875 150.547H152.961C153.122 150.302 153.318 150.076 153.547 149.867C153.781 149.659 154.062 149.495 154.391 149.375C154.724 149.25 155.112 149.188 155.555 149.188ZM155.062 150.688C154.557 150.688 154.151 150.789 153.844 150.992C153.542 151.19 153.32 151.49 153.18 151.891C153.044 152.292 152.971 152.794 152.961 153.398V153.656C152.961 154.297 153.026 154.841 153.156 155.289C153.292 155.732 153.513 156.07 153.82 156.305C154.133 156.534 154.555 156.648 155.086 156.648C155.534 156.648 155.904 156.526 156.195 156.281C156.492 156.036 156.714 155.688 156.859 155.234C157.005 154.781 157.078 154.247 157.078 153.633C157.078 152.701 156.911 151.977 156.578 151.461C156.25 150.945 155.745 150.688 155.062 150.688ZM166.898 155.531C166.898 156.099 166.76 156.578 166.484 156.969C166.208 157.359 165.805 157.656 165.273 157.859C164.747 158.057 164.102 158.156 163.336 158.156C162.732 158.156 162.211 158.112 161.773 158.023C161.341 157.94 160.932 157.81 160.547 157.633V156.047C160.958 156.24 161.419 156.406 161.93 156.547C162.445 156.688 162.932 156.758 163.391 156.758C163.995 156.758 164.43 156.664 164.695 156.477C164.961 156.284 165.094 156.029 165.094 155.711C165.094 155.523 165.039 155.357 164.93 155.211C164.826 155.06 164.628 154.906 164.336 154.75C164.049 154.589 163.628 154.396 163.07 154.172C162.523 153.953 162.062 153.734 161.688 153.516C161.312 153.297 161.029 153.034 160.836 152.727C160.643 152.414 160.547 152.016 160.547 151.531C160.547 150.766 160.849 150.185 161.453 149.789C162.062 149.388 162.867 149.188 163.867 149.188C164.398 149.188 164.898 149.242 165.367 149.352C165.841 149.456 166.305 149.609 166.758 149.812L166.18 151.195C165.789 151.023 165.396 150.883 165 150.773C164.609 150.659 164.211 150.602 163.805 150.602C163.331 150.602 162.969 150.674 162.719 150.82C162.474 150.966 162.352 151.174 162.352 151.445C162.352 151.648 162.411 151.82 162.531 151.961C162.651 152.102 162.857 152.242 163.148 152.383C163.445 152.523 163.857 152.698 164.383 152.906C164.898 153.104 165.344 153.312 165.719 153.531C166.099 153.745 166.391 154.008 166.594 154.32C166.797 154.633 166.898 155.036 166.898 155.531Z"
				fill="white"
			/>
			<defs>
				<filter
					id="filter0_d_40_2390"
					x="0.417969"
					y="0"
					width="253.582"
					height="379"
					filterUnits="userSpaceOnUse"
					colorInterpolationFilters="sRGB"
				>
					<feFlood floodOpacity="0" result="BackgroundImageFix" />
					<feColorMatrix
						in="SourceAlpha"
						type="matrix"
						values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
						result="hardAlpha"
					/>
					<feOffset dy="4" />
					<feGaussianBlur stdDeviation="2" />
					<feComposite in2="hardAlpha" operator="out" />
					<feColorMatrix
						type="matrix"
						values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"
					/>
					<feBlend
						mode="normal"
						in2="BackgroundImageFix"
						result="effect1_dropShadow_40_2390"
					/>
					<feBlend
						mode="normal"
						in="SourceGraphic"
						in2="effect1_dropShadow_40_2390"
						result="shape"
					/>
				</filter>
				<linearGradient
					id="paint0_linear_40_2390"
					x1="98.712"
					y1="95.5978"
					x2="168.074"
					y2="116.539"
					gradientUnits="userSpaceOnUse"
				>
					<stop stopColor="#70EFFF" />
					<stop offset="1" stopColor="#09E3FF" />
				</linearGradient>
			</defs>
		</svg>
	);
};

export default OrcaReader;
